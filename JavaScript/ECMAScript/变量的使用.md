# 变量的使用

> 要想使用变量，首先需要声明变量
>
> 1. 内存：计算机中存储数据的地方，相当于一个空间
> 2. 变量本质：是程序在内存中申请的一块用来存放数据的小空间

## let 关键字

`let `声明的变量只在所处于的块级有效

>**块级作用域：**就是一对 { } 产生的作用域，一对 { } 就代表着一个块级作用域，具有块级作用域的变量只能在块级作用域中访问

```javascript
// 只声明不赋值
let 变量名;

// 声明变量的时候直接完成赋值操作，也称为 变量初始化
let 变量名 = 值;

// 声明多个变量（变量赋值后，还可以给它一个不同的值来更新它）
// 语法：多个变量中间用逗号隔开（为了更好的可读性，建议请一行只声明一个变量）
let 变量名1 = 值1, 变量名2 = 值2;
```

使用`let`关键字声明的变量**没有**变量提升

> let关键字只能先声明，再使用，否则会报错

```javascript
console.log(a);		// a is not defined
let a = 20;

// 使用 let
let arr = [];
// 每次循环都会产生一个块级作用域，每个块级作用域中的变量都是不同的，函数执行时输出的是自己上一级（循环产生的块级作用域）作用域下的 i 值
for (let i = 0; i < 2; i++) {
    arr[i] = function() {
        console.log(i);
    }
}
arr[0]();	// 0
arr[1]();	// 1
```


## const 关键字

> 作用：声明常量，常量就是值（内存地址）不能改变的量

const的特点

1. const 具有块级作用域

2. 使用 `const`声明的是常量，在后面出现的代码中**不能再修改该常量的值**

3. 声明常量是必须赋值

4. 常量赋值后，值不能修改


```javascript
// const 具有块级作用域
if (true) {
	const a = 10;
}
console.log(a)		// a is not defined

//声明常量是必须赋值
const num;		// Missing initializer in const declaration

// 常量赋值后，值不能修改
const PI = 3.14;
PI = 100;		// Assignment to constant variable

// 对于复杂数据来说，里面的值可以更改，但不能整个修改（简单理解：常量保存的是数组，不是数组里面的元素）
const arr = [10, 20];
ary[0] = 'a';	// 此操作没有更改内存地址
ary[1] = 'b';
console.log(ary);		// ['a', 'b']
// 下面操作直接更改内存地址
ary = ['a', 'b'];		// Assignment to constant variable
```

## 暂时性死区

从一个代码块的开始直到代码执行到声明变量的行之前，`let`或`const`声明的变量都处于“ **暂时性死区** ”，如果在声明前使用，则会抛出错误，所以`let`或`const`只能先声明再访问 

**查找会从块级作用域中先开始查找，如果发现下面的代码中有该声明的变量，就不会往上一级继续查找**

```javascript
// 使用let会有暂时性死区
if(true) {
	console.log(num);
	let num = 20;		// 报错
}

// 使用 const 同上
console.log(p);		// 报错
const p = {
    name:'zs'
}

// var声明的全局变量会进行变量提升
console.log(s);		// undefined
var s = {
    n: 2
}
```

## var 语句

`var`语句 用于声明一个函数范围 或 全局范围的变量，并可将其初始化一个值（可选）

`var`声明的变量会被添加到全局对象中（全局属性），可以使用`window`和`glbalThis`访问

> `let`和`const`声明的全局变量则不会添加到全局对象中

```javascript
// var
var name = "zs";
console.log(window.name);		// zs
console.log(globalThis.name);	// zs

// let
let age = 18;
console.log(window.age);		// undefined
console.log(globalThis.age);	// undefined

// const
let gender = "female";
console.log(window.gender);		// undefined
console.log(globalThis.gender);	// undefined
```

使用 `var `声明的变量，其作用域**为该语句所在的函数内，且存在变量提升现象**

1. `var `可以先使用再声明
2. `var `声明过的的变量可以重复声明
3. 有变量提升、全局变量、没有块级作用域等等

```javascript
if(true) {
	let a = 10;
    var b = 20;
}
console.log(a)	// a is not defined
console.log(b)	// 20


// 使用 var
let arr = [];
for (var i = 0; i < 2; i++) {
    arr[i] = function () {
        console.log(i);
    }
}
arr[0]();	// 2
arr[1]();	// 2
```

## let、const、var的区别

| 关键字 | 作用域     | 变量提升 | 重复声明变量 | 暂时性死区 | 全局属性 |
| ------ | ---------- | -------- | ------------ | ---------- | -------- |
| var    | 函数作用域 | 存在     | 是           | 否         | 是       |
| let    | 块级作用域 | 不存在   | 是           | 是         | 否       |
| const  | 块级作用域 | 不存在   | 否           | 是         | 否       |

# 作用域

## 概念

1. 作用域就是代码名字（变量）在某个范围内起作用和效果，目的是为了提高程序的可靠性更重要的是减少命名冲突

2. 全局作用域：整个script标签 或者是一个单独的js文件

3. 局部作用域（函数作用域）：在函数内部就是局部作用域，这个代码的名字只在函数内部起效果和作用

   ```javascript
   function fn(){
   	// 局部作用域
   }
   ```

## 变量的作用域

> 根据作用域的不同，变量分为全局变量和局部变量

全局变量

1. 在全局作用域下声明的变量叫做**全局变量（在函数外部定义的变量）**

2. 全局变量在代码的任何位置都可以使用

3. 在全局作用域下 let 声明的变量 是全局变量

4. 特殊情况下，在函数内不使用 let 声明的变量也是全局变量

   ```javascript
   // 全局变量：在全局作用域下的变量，在全局下都可以使用
   let num = 10;   // num是一个全局变量
   console.log(num); // 10
   
   function fn(){
   	console.log(num); // 输出结果：10
   }
   fn();
   ```

局部变量

1. 在局部作用域下声明的变量叫做**局部变量（在函数内部定义的变量）**

2. 局部变量只能在该函数**内部**使用

3. 在函数内部 lei  声明的变量是局部变量

4. 函数的**形参**实际上就是局部变量

   ```javascript
   // 局部变量：在局部作用域下的变量，后者在函数内部的变量就是 局部变量
       // 函数的形参也可以看做是局部变量
   function fun(aru) {
   	let num = 10; // num1就是局部变量，只能在函数内部使用
   	num1 = 20;
   }
   fun();
   // 如果在函数内部，没有声明直接赋值的变量也属于全局变量
   console.log(num1); // 输出结果：20
   ```

全局变量和局部变量的区别

1. **全局变量**：在任何一个地方都可以使用，只有在浏览器关闭时才会被销毁，因此比较占内存
2. **局部变量**：只有函数内部使用，当其所在的代码块被执行时，会被初始化；**当代码块运行结束后，就会被销毁**，因此更节省内存空间


## 作用域链

作用域链：内部函数访问外部函数的变量

采取的是链式查找的方式来决定取哪个值，这种结构称为作用域链

![](http://127.0.0.1:8888/uploads/202302281637392.jpg) 

# 预解析

JavaScript代码是由浏览器中的JavaScript解析器来执行的。JavaScript解析器在运行JavaScript代码的时候分为两步:预解析和自上而下执行代码、

js引擎运行js分为两步：预解析和自上而下执行代码
1. 预解析： js引擎会把js里面所有的 let 还有 function提升到当前作用域的最前面
2. 代码执行：按照代码书写的顺序从上往下执行
3. 预解析分为变量预解析（变量提升）和函数预解析（函数提升)
4. 变量提升就是把所有的变量声明提升到当前的作用域最前面，不提升赋值操作